<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mind Reader</title>


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"
     integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
     <!-- Added a link to CSS-->
    <link rel="stylesheet" href="assets/css/normalize.css">

    <link rel="stylesheet" href="assets/css/main.css">

    <!-- Added a link to Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700|Merriweather:400,900|Montserrat:400,600,700" rel="stylesheet">

</head>
<body>
<nav class="navbar clearfix">
  <a class="navbar-brand" href="#">
    <img id="mind-reader-logo" src="./assets/img/mind-reader-logo.png"  alt="Mind Reader">
  </a>
</nav>
<!-- ==================================================================================== -->


<div class="row">
  <div class="col-lg-6 offset-lg-3 mb-5">
    <div class="input-group">
      <!-- <span class="input-group-btn"> -->
        <button class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" type="button">All</button>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="#">Clothing, Shoes & jewelery</a>
          <a class="dropdown-item" href="#">Electronics</a>
          <a class="dropdown-item" href="#">Arts & Crafts</a>
          <a class="dropdown-item" href="#">Gift Cards</a>
          <a class="dropdown-item" href="#">Toys& Games</a>
          <div role="separator" class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Separated link</a>
        </div>
      <!-- </span> -->
      <input name="query" id="query" type="text" class="form-control" placeholder="Product name" aria-label="Product name">
      <span class="input-group-btn">
        <button id="submitbtn" class="btn btn-secondary" type="button">Search</button>
      </span>
    </div>
  </div>
</div>

<div id="results">

</div>
<!-- =================================================================================== -->
<div class= "main">
    
</div>
</body>
<!-- ================================================================================================================================================= -->
<script src="https://code.jquery.com/jquery-3.2.1.min.js"integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="crossorigin="anonymous"></script>
<script type="text/javascript">
  $(document).ready(() => {
    // alert(' Loaded ')

    function searchNow() {
      if($('#query').val() != '') {
        const searchTerm = $('#query').val();
        $('#results').empty();
        const url = `http://localhost:3000/getproducts?query=${searchTerm}`;
        $.getJSON(url, (response) => {
          const searchedFor = response.query
          const numberOfResults = response.numItems
          const products = response.items;
          $('#results').append(`<h3> ${numberOfResults} results found for ${searchedFor} </h3>`);
          products.forEach((product) => {
            //console.log(product)
            let productHTML = '';
            const productId = product.itemId;
            const productName = product.name;
            const productPrice = product.salePrice;
            const productImage = product.mediumImage;
            const productRating = product.customerRating || 'not rated';

            productHTML += `
              <div class="product">
              <img id='img-${productId}' scr=''>
              <p> ${productName} </p>
              <p> Price: <strong> $${productPrice} </strong> </p>
              <p> Rating: ${productRating} </p>
              </div>
            `
            $('#results').append(productHTML);

            $(`#img-${productId}`).attr("src", productImage);
            $(`#img-${productId}`).attr("width", '200px');
            $(`#img-${productId}`).attr("height", '200px');

          });
        });
      } else {
        alert('Please enter a search term')
      }
    }

    $('#submitbtn').on('click', (event) => {
      searchNow();
    });
    $('#query').on('keyup', (event) => {
      const code = event.keyCode || event.which;
      if(code == 13) {
        searchNow();
      }
    });

  });
</script>
<!-- ================================================================================= -->
</html>
