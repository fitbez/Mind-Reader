<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mind Reader</title>


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"
     integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

     <!-- Added a link to CSS-->
    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/main.css">

    <!-- Added a link to Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700|Merriweather:400,900|Montserrat:400,600,700" rel="stylesheet">

</head>
<body>
<nav class="navbar clearfix">
  <a class="navbar-brand" href="#">
    <img id="mind-reader-logo" src="./assets/img/mind-reader-logo.png"  alt="Mind Reader">
  </a>
</nav>
<!-- ==================================================================================== -->
<div id="accordion" role="tablist">
  <div class="card">
    <div class="card-header" role="tab" id="headingOne">
      <h5 class="mb-0">
        <a class="collapsed" data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
        <img src="http://www.freeiconspng.com/uploads/walmart-logo-png-25.png" alt="Walmart">
        </a>
      </h5>
    </div>

    <div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">
        <div class="row">
          <div class="col-lg-6 offset-lg-3 mt-5 mb-5">
            <div class="input-group">
              <div class="input-group-btn">
                <button class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">All
                  <span class="sr-only">Toggle Dropdown</span>
                </button>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="#">Clothing, Shoes & jewelery</a>
                  <a class="dropdown-item" href="#">Electronics</a>
                  <a class="dropdown-item" href="#">Arts & Crafts</a>
                  <a class="dropdown-item" href="#">Gift Cards</a>
                  <a class="dropdown-item" href="#">Toys& Games</a>
                  <div role="separator" class="dropdown-divider"></div>
                  <a class="dropdown-item" href="#">Separated link</a>
                </div>
              </div>
              <input name="query" id="query" type="text" class="form-control" placeholder="Product name" aria-label="Product name">
              <span class="input-group-btn">
                <button id="submitbtn" class="btn btn-secondary" type="button">Search</button>
              </span>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" role="tab" id="headingTwo">
      <h5 class="mb-0">
        <a class="collapsed " data-toggle="collapse" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
    <img src="https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/512/ebay-128.png" alt="ebay">
        </a>
      </h5>
    </div>
    <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo" data-parent="#accordion">
      <div class="card-body">
        <div class="row">
          <div class="col-lg-6 offset-lg-3 mt-5 mb-5">
            <div class="input-group">
              <div class="input-group-btn">
                <button class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">All
                  <span class="sr-only">Toggle Dropdown</span>
                </button>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="#">Clothing, Shoes & jewelery</a>
                  <a class="dropdown-item" href="#">Electronics</a>
                  <a class="dropdown-item" href="#">Arts & Crafts</a>
                  <a class="dropdown-item" href="#">Gift Cards</a>
                  <a class="dropdown-item" href="#">Toys& Games</a>
                  <div role="separator" class="dropdown-divider"></div>
                  <a class="dropdown-item" href="#">Separated link</a>
                </div>
              </div>
              <input name="query" id="query" type="text" class="form-control" placeholder="Product name" aria-label="Product name">
              <span class="input-group-btn">
                <button id="submitbtn" class="btn btn-secondary" type="button">Search</button>
              </span>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
<div id="results" style="margin-left:40px;">

</div>
<!-- =================================================================================== -->
<div class="main">

</div>

</body>
<!-- ================================================================================================================================================= -->
<!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="crossorigin="anonymous"></script>
    <script type="text/javascript">
  $(document).ready(() => {
    // alert(' Loaded ')

    function searchNow() {
      if($('#query').val() != '') {
        const searchTerm = $('#query').val();
        $('#results').empty();
        const url = `http://localhost:3000/getproducts?query=${searchTerm}`;
        $.getJSON(url, (response) => {
          const searchedFor = response.query
          const numberOfResults = response.numItems
          const products = response.items;
          $('#results').append(`<h3> ${numberOfResults} results found for ${searchedFor} </h3>`);
          products.forEach((product) => {
            //console.log(product)
            let productHTML = '';
            const productId = product.itemId;
            const productName = product.name;
            const productPrice = product.salePrice;
            const productImage = product.mediumImage;
            const productRating = product.customerRating || 'not rated';

            productHTML += `
              <div class="product" style="float:left">
              <img id='img-${productId}' scr=''>
              <p> ${productName} </p>
              <p> Price: <strong> $${productPrice} </strong> </p>
              <p> Rating: ${productRating} </p>
              </div>
            `
            $('#results').append(productHTML);

            $(`#img-${productId}`).attr("src", productImage);
            $(`#img-${productId}`).attr("width", '200px');
            $(`#img-${productId}`).attr("height", '200px');

          });
        });
      } else {
        alert('Please enter a search term')
      }
    }

    $('#submitbtn').on('click', (event) => {
      searchNow();
    });
    $('#query').on('keyup', (event) => {
      const code = event.keyCode || event.which;
      if(code == 13) {
        searchNow();
      }
    });

  });
</script>

<!-- ================================================================================= -->
</html>
